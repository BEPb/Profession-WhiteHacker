### 7.1 Введение в уровень

#### Основные понятия

Социальная инженерия (атака) — обман, манипулирование и мошенничество с использованием социальных и психологических
аспектов человеческой жизни.

Разведка по открытым источникам (Open Source Intelligence, OSINT) — разведывательная дисциплина, включающая в себя
поиск, выбор и сбор разведывательной информации из общедоступных источников, а также её анализ.

### Эксплуатация «человеческого фактора»

«Человеческий фактор» является самым уязвимым звеном любой системы (системы безопасности — в том числе). Поэтому атаки
социальной инженерии основаны на технических решениях и инструментах, которые используют на первом шаге уязвимости
мышления и поведения человека и только на последующих шагах — уязвимости информационных систем.

Цели атак с применением методов социальной инженерии:

- Выполнение жертвой (сознательно либо неосознанно) необходимых действий
- Раскрытие необходимой информации

Злоумышленники по всему миру используют именно эти техники проведения первичных атак как самые эффективные и работающие
безотказно.

За счёт чего достигается такая высокая степень эффективности?

С системой вы можете не справиться, т.к. в ней может не быть уязвимого поведения. В мышлении человека, использующего эту
систему, всегда найдутся установка/убеждение, благодаря которым вы спровоцируете его совершить нужные вам действия,
чтобы получить доступ к закрытым информационным ресурсам.

### Принципы Чалдини

В 1984 году американский психолог Роберт Чалдини (Robert Cialdini) опубликовал книгу под названием «Психология
влияния», в которой изложил шесть принципов убеждения ("six principles of influence"):

#### 1. Взаимность (Reciprocity): "Люди платят тем же"

Мы чувствуем обязанность "вернуть долг" людям, от которых мы что-то получили. Это работает следующим образом:

Дайте что-то.
Через какое-то время (не сразу) попросите что-нибудь взамен: возможно, вы даже получите больше.
Примеры использования принципа хакером:

    - Звоним на ресепшен и говорим: "Я вашему генеральному директору только что отправил посылку
    из [название другой компании] / его заказ из [название сервиса], но у нас оборвался звонок, не могу ему перезвонить —
    почему-то попадаю на вас. Подскажете его актуальный номер телефона?"
      - Отправляем письмо: "Коллеги, я за вас сделал работу [придумываем, какую], пожалуйста, проверьте её: перейдите по
      ссылке [адрес ссылки], посмотрите, всё ли корректно?"

#### 2. Обязательность и последовательность (Commitment and consistency)

Дав обещание, высказав свою точку зрения или заняв определенную позицию, большинство людей предпочитают ее
придерживаться. Даже если мы оказались неправы либо наши обещания уже не имеют практического смысла, мы склонны
оправдывать свои обязательства или казаться последовательными в своём мнении (часто по факту последовательными не
являясь). По сути, мы вынуждены изобретать обоснования для подтверждения того, что сделали правильный выбор.

Пример использования принципа хакером:

    Осторожно "продавить" другого человека на выполнение какого-либо его собственного обещания.

#### 3. Социальное доказательство (Social proof)

Люди следуют схожему примеру других (особенно когда нет уверенности, что именно надо делать). Люди, как социальные
существа, в большой степени полагаются на сигналы от окружающих о том, как им мыслить, чувствовать и действовать.

Пример использования принципа хакером:

    Пишем человеку: "Все твои коллеги уже сделали [какое-либо стандартное рабочее действие], не сделал только ты, как можно
    скорее отправь письмо / перейди по ссылке [адрес ссылки] / скачай файл ..."

#### 4. Власть и авторитет (Authority): "Доверьтесь знающему человеку"

Люди склонны подчиняться тем, кто имеет власть, авторитет, знатокам своего дела, даже если они призывают к
сомнительным действиям.

Пример использования принципа хакером:

    Звоним сотруднику какой-либо крупной компании (такой, в которой люди не знаю в лицо своего генерального директора) и
    говорим: "Привет, это [имя и фамилия генерального директора], хочу, чтобы ты лично сделал вот это: как можно скорее
    отправь письмо / перейди по ссылке [адрес ссылки] / скачай файл / пришли мне номер телефона ..."

#### 5. Сходство и симпатия (Liking)

Люди любят тех, кто похож на них, и тех, кто любит их. Если вы хотите влиять на людей, делайте их своими друзьями.
Особенно важны подобие и похвала. Подобие по-настоящему единит людей.

Пример использования принципа хакером:

    то же, что и в предыдущем примере, только представляетесь не генеральным директором, а кем-то, кто очень похож по
    занимаемой позиции в компании / образу мыслей и паттернам поведения на вашего адресата (например, его коллега).

#### 6. Дефицит (Scarcity)

Возможности кажутся более ценными, желанными, когда они становятся менее доступными. Если у нас есть выбор: получить
что-либо сейчас или или получить это же в будущем, мы выбираем — получить сейчас. При этом не факт, что нам этот предмет
или эта услуга вообще нужны.

Пример использования принципа хакером:

    Отправляем письмо: "Мы оформляем подписку на корпоративную программу фитнеса, мест всего 100, пожалуйста,
    зарегистрируйтесь по ссылке [адрес ссылки] ..."

### Общие принципы

Перечислим все этапы, которые были показаны в базовом примере:

Поиск информации о целях
Подготовка сценариев атак
Применение сценариев атак и замер результатов
Эти этапы лягут в основу действий по подготовке сценариев социотехнического тестирования — имитации атак социальной
инженерии. Рассмотрим дальше каждый из этих этапов.

### Этап 1. Поиск информации о целях

Список информации о целях детализируется от больших к меньшим. По мере уточнения данных нам будут полезны следующие
сущности в организации:

Компания → Участники организационная структуры компании → Сотрудники

Конечная цель — получить информацию о сотрудниках компании, которые имеют требуемый уровень доступа, и собрать
потенциально удобные в использовании «легенды» для подготовки сценария компрометации.

На этом этапе мы изучаем:

Компанию: профиль, процессы, роли, управляющий орган, контактные данные и пр.

Большую часть информации о компании мы получаем, изучая её сайт. Также можно искать информацию в открытых источниках,
через поисковые запросы в популярных поисковиках: yandex.ru, google.com, bing.com либо сразу при помощи платформ СПАРК,
rusprofile и пр.

Организационную структуру: существующие департаменты и отделы в компании, связанность и подчиненность ролей и
подразделений, открытые вакансии внутри компании

На сайте компании мы также получаем информацию о структуре компании и открытых в ней вакансиях. Дополнительно об этом мы
можем узнать из заявок компании на hh.ru (в т.ч. архивных). Детали устройства компании, процессов и проблем в ней мы
найти на сайтах отзывов о работодателях:

    https://www.glassdoor.com/
    https://maps.yandex.ru/
    https://pravda-sotrudnikov.ru/

Сотрудников: контактные данные сотрудников, имена, должности, линейных руководителей, роли в компании

Поиск контактных данных сотрудников упрощен, т.к. существует множество инструментов, решающих конкретные задачи поиска
данных об email-адресах и номерах телефонов сотрудников, связанных с целевой компанией:

Инструменты:

    Infoga - https://github.com/m4ll0k/Infoga
    FocaPro - https://github.com/ElevenPaths/FOCA
    TheHarvester - https://github.com/laramies/theHarvester
Ресурсы:

    hunter.io
    snov.io
    intelx.io
Техники:

    SMTP User Enumeration (RCPT TO, MAIL FROM, VRFY) - энумерация (перебор) пользователей почтового сервера через протокол
    SMTP
    OWA (Outlook Web Access) Enumeration - энумерация (перебор) пользователей почтового сервера через веб-страницу Outlook
    Web Access.
Все эти данные дают нам возможность составить комбинацию фактов и закономерностей, позволяющих подготовить наиболее
правдоподобный сценарий тестирования.